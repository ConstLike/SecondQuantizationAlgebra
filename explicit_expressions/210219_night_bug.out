default [[0, 1], [0, 1]]
default [[0, 1], [0, 1]]
pure
 (   1.00000) W(a2,a3,i2,i3) E2(i2,i3,a2,a3) t2(i0,i1,a0,a1) E2(a0,a1,i0,i1) 

normal order form
 (   1.00000) W(a2,a3,i2,i3) t2(i0,i1,a0,a1) E4(i2,i3,a0,a1,a2,a3,i0,i1)  [[0, 1, 0, 1], [2, 3, 2, 3]]          i0-a0, i1-a1 should have same spin in E4 but it is not accounted
 (   1.00000) kdelta(a2,a0) W(a2,a3,i2,i3) t2(i0,i1,a0,a1) E3(i2,i3,a1,i0,a3,i1)  [[0, 1, 1], [3, 0, 3]]
 (  -1.00000) kdelta(a2,a1) W(a2,a3,i2,i3) t2(i0,i1,a0,a1) E3(i2,i3,a0,i1,a3,i0)  [[0, 1, 1], [2, 2, 0]]
 (  -1.00000) kdelta(a3,a0) W(a2,a3,i2,i3) t2(i0,i1,a0,a1) E3(i2,i3,a1,a2,i0,i1)  [[0, 1, 0], [3, 1, 3]]
 (   1.00000) kdelta(a3,a1) W(a2,a3,i2,i3) t2(i0,i1,a0,a1) E3(i2,i3,a0,a2,i1,i0)  [[0, 1, 0], [2, 2, 1]]
 (   1.00000) kdelta(a3,a1) kdelta(a2,a0) W(a2,a3,i2,i3) t2(i0,i1,a0,a1) E2(i2,i3,i0,i1)  [[0, 1], [0, 1]]
 (  -1.00000) kdelta(a3,a0) kdelta(a2,a1) W(a2,a3,i2,i3) t2(i0,i1,a0,a1) E2(i2,i3,i1,i0)  [[0, 1], [1, 0]]

re-obtain spin-free operator
 (   1.00000) W(a2,a3,i2,i3) t2(i0,i1,a0,a1) E4(i2,i3,a0,a1,a2,a3,i0,i1)  [[0, 1, 0, 1], [2, 3, 2, 3]]
 (   1.00000) kdelta(a2,a0) W(a2,a3,i2,i3) t2(i0,i1,a0,a1) E3(i2,i3,a1,i0,a3,i1)  [[0, 1, 1], [3, 0, 3]]
 (  -1.00000) kdelta(a2,a1) W(a2,a3,i2,i3) t2(i0,i1,a0,a1) E3(i2,i3,a0,i1,a3,i0)  [[0, 1, 1], [2, 2, 0]]
 (  -1.00000) kdelta(a3,a0) W(a2,a3,i2,i3) t2(i0,i1,a0,a1) E3(i2,i3,a1,a2,i0,i1)  [[0, 1, 0], [3, 1, 3]]
 (   1.00000) kdelta(a3,a1) W(a2,a3,i2,i3) t2(i0,i1,a0,a1) E3(i2,i3,a0,a2,i1,i0)  [[0, 1, 0], [2, 2, 1]]
 (   1.00000) kdelta(a3,a1) kdelta(a2,a0) W(a2,a3,i2,i3) t2(i0,i1,a0,a1) E2(i2,i3,i0,i1)  [[0, 1], [0, 1]]
 (  -1.00000) kdelta(a3,a0) kdelta(a2,a1) W(a2,a3,i2,i3) t2(i0,i1,a0,a1) E2(i2,i3,i1,i0)  [[0, 1], [1, 0]]   

HF Fermi expectation form
 (   0.00000) W(a2,a3,i2,i3) t2(i0,i1,a0,a1) E4(i2,i3,a0,a1,a2,a3,i0,i1)                                          based on upper spins, contraction should account the spin sum
 (   0.00000) kdelta(a2,a0) W(a2,a3,i2,i3) t2(i0,i1,a0,a1) E3(i2,i3,a1,i0,a3,i1) 
 (   0.00000) kdelta(a2,a1) W(a2,a3,i2,i3) t2(i0,i1,a0,a1) E3(i2,i3,a0,i1,a3,i0) 
 (   0.00000) kdelta(a3,a0) W(a2,a3,i2,i3) t2(i0,i1,a0,a1) E3(i2,i3,a1,a2,i0,i1) 
 (   0.00000) kdelta(a3,a1) W(a2,a3,i2,i3) t2(i0,i1,a0,a1) E3(i2,i3,a0,a2,i1,i0) 
 (   4.00000) kdelta(a3,a1) kdelta(a2,a0) W(a2,a3,i2,i3) t2(i0,i1,a0,a1) kdelta(i2,i0) kdelta(i3,i1) 
 (  -4.00000) kdelta(a3,a0) kdelta(a2,a1) W(a2,a3,i2,i3) t2(i0,i1,a0,a1) kdelta(i2,i1) kdelta(i3,i0) 

contract form
 (   0.00000) W(a2,a3,i2,i3) t2(i0,i1,a0,a1) E4(i2,i3,a0,a1,a2,a3,i0,i1) 
 (   0.00000) W(a0,a3,i2,i3) t2(i0,i1,a0,a1) E3(i2,i3,a1,i0,a3,i1) 
 (   0.00000) W(a1,a3,i2,i3) t2(i0,i1,a0,a1) E3(i2,i3,a0,i1,a3,i0) 
 (   0.00000) W(a2,a0,i2,i3) t2(i0,i1,a0,a1) E3(i2,i3,a1,a2,i0,i1) 
 (   0.00000) W(a2,a1,i2,i3) t2(i0,i1,a0,a1) E3(i2,i3,a0,a2,i1,i0) 
 (   4.00000) W(a0,a1,i0,i1) t2(i0,i1,a0,a1) 
 (  -4.00000) W(a1,a0,i1,i0) t2(i0,i1,a0,a1) 

remove near zero terms
 (   4.00000) W(a0,a1,i0,i1) t2(i0,i1,a0,a1) 
 (  -4.00000) W(a1,a0,i1,i0) t2(i0,i1,a0,a1) 

change idx
 (   4.00000) W(a0,a1,i0,i1) t2(i0,i1,a0,a1) 
 (  -4.00000) W(a0,a1,i0,i1) t2(i1,i0,a1,a0) 

obtain weight factors
 (  16.00000) W(a0,a1,i0,i1) t2(i0,i1,a0,a1) 
 ( -16.00000) W(a0,a1,i0,i1) t2(i1,i0,a1,a0) 

non eq idx sort
eq
noneq
 (  16.00000) W(a0,a1,i0,i1) t2(i0,i1,a0,a1) 
 ( -16.00000) W(a0,a1,i0,i1) t2(i1,i0,a1,a0) 

